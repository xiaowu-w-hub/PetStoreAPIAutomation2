package api.test;import api.endpoints.UserEnderPoints;import api.endpoints.UserEnderPoints2;import api.payload.User;import com.github.javafaker.Faker;import io.restassured.response.Response;import org.apache.logging.log4j.LogManager;import org.apache.logging.log4j.core.Logger;import org.testng.Assert;import org.testng.annotations.BeforeClass;import org.testng.annotations.Test;public class UserTest2 {    Faker faker;    User userPayload;    public Logger loggers;    @BeforeClass    public void setData(){        faker = new Faker();        userPayload = new User();        userPayload.setId(faker.idNumber().hashCode());        userPayload.setUsername(faker.name().username());        userPayload.setFirstName(faker.name().firstName());        userPayload.setLastName(faker.name().lastName());        userPayload.setEmail(faker.internet().emailAddress());        userPayload.setPassword(faker.internet().password());        userPayload.setPhone(faker.phoneNumber().cellPhone());        //logs        loggers = (Logger) LogManager.getLogger(this.getClass());    }    @Test(priority = 1)    public void testPostUser(){        loggers.info("***************   Creating User   *******************");        Response response= UserEnderPoints2.createUser(userPayload);        response.then().log().all();        Assert.assertEquals(response.getStatusCode(),200);        loggers.info("***************   User is created   *******************");    }    @Test(priority = 2)    public void testGetUserByName() throws InterruptedException {        loggers.info("***************   Getting User   *******************");        Response response = null;        int maxRetries = 5;        int retryInterval = 3000; // 2秒间隔        for (int i = 0; i < maxRetries; i++) {            response = UserEnderPoints2.readUser(this.userPayload.getUsername());            if (response.getStatusCode() == 200) {                loggers.info("User is ready after " + (i + 1) + " attempts.");                break;            }            loggers.warn("User not ready yet (attempt " + (i + 1) + "), waiting " + retryInterval + "ms...");            Thread.sleep(retryInterval);        }        System.out.println("user name is"+this.userPayload.getUsername());        response.then().log().all();        Assert.assertEquals(response.getStatusCode(),200,"user should be get");        loggers.info("***************   User is displayed   *******************");    }    @Test(priority = 3)    public void testUpdateUser() throws InterruptedException {        loggers.info("***************   Updating User   *******************");        // 等待，确保 user 已创建并可查询       Thread.sleep(10000);        userPayload.setLastName(faker.name().lastName());        userPayload.setEmail(faker.internet().emailAddress());        userPayload.setPassword(faker.internet().password());        Response response = UserEnderPoints2.updateUser(this.userPayload.getUsername(),userPayload);        response.then().log().all();        Assert.assertEquals(response.getStatusCode(),200);        Response responseAfterudpate = UserEnderPoints2.readUser(this.userPayload.getUsername());        Assert.assertEquals(responseAfterudpate.getStatusCode(),200);        loggers.info("***************   User is updated   *******************");    }    @Test(priority = 4)    public void testDeleteUser() throws InterruptedException {        loggers.info("***************   Deleting User   *******************");        Thread.sleep(20000);        Response response = UserEnderPoints2.deleteUser(this.userPayload.getUsername());        Assert.assertEquals(response.getStatusCode(),200);        loggers.info("***************   User is deleted   *******************");    }}